<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.
broadcast chan ASense, VSense, APace, VPace;
clock globalClock;</declaration><template><name x="5" y="5">Heart</name><parameter>const int  &amp;minwait_A, const int &amp;minwait_V</parameter><declaration>// Place local declarations here.
clock x;</declaration><location id="id0" x="264" y="0"></location><init ref="id0"/><transition><source ref="id0"/><target ref="id0"/><label kind="guard" x="16" y="-48">x &gt;= minwait_A</label><label kind="synchronisation" x="48" y="-32">ASense!</label><label kind="assignment" x="72" y="-16">x:=0</label><nail x="112" y="-112"/><nail x="120" y="72"/></transition><transition><source ref="id0"/><target ref="id0"/><label kind="guard" x="224" y="-160">x &gt;= minwait_V</label><label kind="synchronisation" x="240" y="-136">VSense!</label><label kind="assignment" x="248" y="-120">x:=0</label><nail x="400" y="-136"/><nail x="144" y="-136"/></transition><transition><source ref="id0"/><target ref="id0"/><label kind="synchronisation" x="448" y="-32">VPace?</label><label kind="assignment" x="456" y="-16">x:=0</label><nail x="440" y="80"/><nail x="440" y="-112"/></transition><transition><source ref="id0"/><target ref="id0"/><label kind="synchronisation" x="256" y="112">APace?</label><label kind="assignment" x="264" y="136">x:=0</label><nail x="168" y="136"/><nail x="408" y="136"/></transition></template><template><name>Monitor</name><declaration>clock amClock;
clock vmClock;
int amTime;
int vmTime;
const int mLRI = 1000;
const int mAVI = 250;
const int mPVARP = 300;
const int mVRP = 200;</declaration><location id="id1" x="-184" y="0"><name x="-248" y="-8">VPaced</name><committed/></location><location id="id2" x="208" y="-16"><name x="198" y="-46">VSensed</name><committed/></location><location id="id3" x="40" y="192"><name x="24" y="208">APaced</name><committed/></location><location id="id4" x="-8" y="-168"><name x="-18" y="-198">ASensed</name><committed/></location><location id="id5" x="16" y="-8"></location><init ref="id5"/><transition><source ref="id5"/><target ref="id3"/><label kind="synchronisation" x="112" y="128">APace?</label><label kind="assignment" x="-32" y="92">amClock := 0</label><nail x="120" y="96"/></transition><transition><source ref="id3"/><target ref="id5"/><nail x="-56" y="120"/></transition><transition><source ref="id2"/><target ref="id5"/><nail x="144" y="56"/></transition><transition><source ref="id5"/><target ref="id2"/><label kind="synchronisation" x="52" y="-27">VSense?</label><label kind="assignment" x="52" y="-12">vmClock :=0</label><nail x="120" y="-48"/></transition><transition><source ref="id5"/><target ref="id4"/><label kind="synchronisation" x="-120" y="-128">ASense?</label><label kind="assignment" x="-56" y="-88">amClock := 0</label><nail x="-88" y="-72"/></transition><transition><source ref="id4"/><target ref="id5"/><nail x="80" y="-104"/></transition><transition><source ref="id5"/><target ref="id1"/><label kind="synchronisation" x="-152" y="48">VPace?</label><label kind="assignment" x="-144" y="0">vmClock := 0</label><nail x="-72" y="56"/></transition><transition><source ref="id1"/><target ref="id5"/><nail x="-120" y="-56"/></transition></template><template><name x="5" y="5">Pacemaker</name><declaration>// Place local declarations here.

clock a_clk,v_clk;
int asenseig;

const int LRI = 1000;
const int CONSTAVI = 150;
int AVI = 150;
const int PVARP = 300;
const int VRP = 200;

const int PAVB = 40; // Generally in the range of 10-60 ms
const int VSP = 100; // Generally in the range of 100-110 ms
const int URI = 700; // URI must be greater than AVI+PVARP
const int AVIOFFSET = 10; // sAVI &lt; pAVI 

const int SYN = 1000;
</declaration><location id="id6" x="-216" y="-128"><name x="-192" y="-144">S1b</name><committed/></location><location id="id7" x="-144" y="32"><name x="-176" y="56">AVIExtended</name><label kind="invariant" x="-216" y="40">v_clk &lt;= URI</label></location><location id="id8" x="-344" y="-248"><name x="-352" y="-288">VSenseInVSP</name><label kind="invariant" x="-328" y="-272">a_clk &lt;= VSP</label></location><location id="id9" x="-432" y="-288"><name x="-424" y="-320">S5</name><label kind="invariant" x="-536" y="-296">a_clk &lt;= VSP</label></location><location id="id10" x="-568" y="-336"><name x="-720" y="-376">VSenseIgnoredByPAVB</name><committed/></location><location id="id11" x="-584" y="-424"><name x="-672" y="-464">ASenseIgnoredS4</name><committed/></location><location id="id12" x="-472" y="-384"><name x="-496" y="-416">S4</name><label kind="invariant" x="-456" y="-392">a_clk &lt;= PAVB</label></location><location id="id13" x="32" y="-200"><name x="8" y="-232">ASenseIgnoredS1a</name><committed/></location><location id="id14" x="-152" y="-200"><name x="-248" y="-232">VSenseIgnoredS1a</name><committed/></location><location id="id15" x="0" y="-80"><name x="-8" y="-56">S1c</name><label kind="invariant" x="16" y="-72">v_clk&lt;=VRP</label></location><location id="id16" x="656" y="-144"><name x="646" y="-174">VSenseIgnoredS3</name><committed/></location><location id="id17" x="288" y="-192"><name x="168" y="-224">ASenseIgnoredS2</name><committed/></location><location id="id18" x="-384" y="8"><name x="-440" y="24">ASenseIgnoredS1</name><committed/></location><location id="id19" x="560" y="-88"><name x="550" y="-118">S3</name><label kind="invariant" x="550" y="-73">v_clk &lt;= LRI-AVI</label></location><location id="id20" x="-568" y="-224"><committed/></location><location id="id21" x="144" y="-96"><name x="134" y="-126">S2</name><label kind="invariant" x="144" y="-80">v_clk&lt;=PVARP</label></location><location id="id22" x="-336" y="-112"><name x="-360" y="-144">S1</name><label kind="invariant" x="-440" y="-104">a_clk&lt;=AVI</label></location><location id="id23" x="-672" y="-112"><label kind="invariant" x="-720" y="-144">a_clk &lt;= SYN</label></location><init ref="id23"/><transition><source ref="id6"/><target ref="id15"/><label kind="synchronisation" x="-152" y="-127">VPace!</label><label kind="assignment" x="-152" y="-112">v_clk := 0</label></transition><transition><source ref="id22"/><target ref="id6"/><label kind="guard" x="-328" y="-160">(a_clk &gt;= AVI) &amp;&amp; (v_clk &gt;= URI)</label></transition><transition><source ref="id7"/><target ref="id15"/><label kind="guard" x="-136" y="-56">v_clk &gt;= URI</label><label kind="synchronisation" x="-144" y="-8">VPace!</label><label kind="assignment" x="-160" y="-32">v_clk := 0</label></transition><transition><source ref="id22"/><target ref="id7"/><label kind="guard" x="-256" y="-24">a_clk &gt;= AVI</label></transition><transition><source ref="id9"/><target ref="id8"/><label kind="synchronisation" x="-408" y="-296">VSense?</label></transition><transition><source ref="id8"/><target ref="id15"/><label kind="assignment" x="-320" y="-200">v_clk := 0</label></transition><transition><source ref="id9"/><target ref="id22"/></transition><transition><source ref="id12"/><target ref="id9"/></transition><transition><source ref="id10"/><target ref="id12"/><nail x="-496" y="-344"/></transition><transition><source ref="id12"/><target ref="id10"/><label kind="synchronisation" x="-584" y="-392">VSense?</label><nail x="-536" y="-376"/></transition><transition><source ref="id11"/><target ref="id12"/><nail x="-536" y="-392"/></transition><transition><source ref="id12"/><target ref="id11"/><label kind="synchronisation" x="-544" y="-448">ASense?</label><nail x="-504" y="-424"/></transition><transition><source ref="id19"/><target ref="id12"/><label kind="guard" x="-136" y="-408">v_clk &gt;= LRI-AVI</label><label kind="synchronisation" x="-128" y="-448">APace!</label><label kind="assignment" x="-48" y="-448">a_clk := 0, AVI = CONSTAVI</label><nail x="216" y="-400"/><nail x="-456" y="-448"/></transition><transition><source ref="id22"/><target ref="id15"/><label kind="synchronisation" x="-104" y="88">VSense?</label><label kind="assignment" x="-192" y="112">v_clk := 0</label><nail x="-200" y="104"/><nail x="-120" y="104"/></transition><transition><source ref="id19"/><target ref="id15"/><label kind="synchronisation" x="240" y="-296">VSense?</label><label kind="assignment" x="200" y="-264">v_clk := 0</label><nail x="240" y="-280"/><nail x="-144" y="-256"/></transition><transition><source ref="id21"/><target ref="id15"/><label kind="synchronisation" x="-80" y="-320">VSense?</label><label kind="assignment" x="0" y="-320">v_clk := 0</label><nail x="160" y="-280"/><nail x="-120" y="-296"/></transition><transition><source ref="id13"/><target ref="id15"/><nail x="8" y="-184"/></transition><transition><source ref="id15"/><target ref="id13"/><label kind="synchronisation" x="32" y="-144">ASense?</label><nail x="56" y="-160"/></transition><transition><source ref="id15"/><target ref="id21"/></transition><transition><source ref="id14"/><target ref="id15"/><nail x="-152" y="-176"/></transition><transition><source ref="id15"/><target ref="id14"/><label kind="synchronisation" x="-136" y="-208">VSense?</label><nail x="-128" y="-184"/></transition><transition><source ref="id16"/><target ref="id19"/><nail x="560" y="-160"/></transition><transition><source ref="id19"/><target ref="id16"/><label kind="synchronisation" x="560" y="-104">VSense?</label><nail x="600" y="-112"/></transition><transition><source ref="id17"/><target ref="id21"/><nail x="248" y="-200"/></transition><transition><source ref="id21"/><target ref="id17"/><label kind="synchronisation" x="272" y="-144">ASense?</label><nail x="272" y="-136"/></transition><transition><source ref="id18"/><target ref="id22"/><nail x="-344" y="0"/></transition><transition><source ref="id22"/><target ref="id18"/><label kind="synchronisation" x="-440" y="-64">ASense?</label><nail x="-416" y="-8"/></transition><transition><source ref="id20"/><target ref="id22"/><label kind="synchronisation" x="-496" y="-208">APace!</label><label kind="assignment" x="-448" y="-192">a_clk := 0</label></transition><transition><source ref="id23"/><target ref="id22"/><label kind="synchronisation" x="-552" y="-136">ASense?</label><label kind="assignment" x="-564" y="-112">a_clk := 0</label></transition><transition><source ref="id19"/><target ref="id22"/><label kind="synchronisation" x="104" y="216">ASense?</label><label kind="assignment" x="24" y="184">a_clk := 0, AVI := CONSTAVI - AVIOFFSET</label><nail x="280" y="216"/><nail x="128" y="248"/><nail x="-200" y="240"/><nail x="-288" y="232"/></transition><transition><source ref="id21"/><target ref="id19"/></transition><transition><source ref="id23"/><target ref="id20"/><label kind="guard" x="-688" y="-208">a_clk&gt;=SYN</label></transition></template><system>// Place template instantiations here.
Heart_Process = Heart(10, 10);
Pacemaker_Process = Pacemaker();
Monitor_Process = Monitor();
// List one or more processes to be composed into a system.
system Heart_Process, Monitor_Process, Pacemaker_Process ;</system></nta>